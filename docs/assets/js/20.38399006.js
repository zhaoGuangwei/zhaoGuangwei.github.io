(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{402:function(s,a,t){"use strict";t.r(a);var n=t(42),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"kvdb-用户手册"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kvdb-用户手册"}},[s._v("#")]),s._v(" KVDB 用户手册")]),s._v(" "),t("h2",{attrs:{id:"简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[s._v("#")]),s._v(" 简介")]),s._v(" "),t("p",[t("code",[s._v("KVDB")]),s._v("是一个简单的"),t("code",[s._v("NoSQL")]),s._v("数据库，支持简单的“键值”读写操作。目前KVDB为试验产品，未对事务进行处理。")]),s._v(" "),t("p",[t("code",[s._v("KVDB")]),s._v("包装了"),t("code",[s._v("RocksDB")]),s._v("作为数据库引擎，实现了单机部署和集群部署。在集群环境下，注意配置“同时开启的文件数”（ulimit -n可查看）。")]),s._v(" "),t("p",[t("code",[s._v("KVDB")]),s._v("的集群是一个分布式的分片服务集群，每个分片节点是一个"),t("code",[s._v("KVDB")]),s._v("的数据库服务实例，采用对等模式部署，没有主节点。")]),s._v(" "),t("h2",{attrs:{id:"安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),t("blockquote",[t("p",[s._v("java 版本>= 1.8")])]),s._v(" "),t("p",[s._v("下载源代码，执行：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("mvn clean package\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("code",[s._v("kvdb-server")]),s._v("模块"),t("code",[s._v("target")]),s._v("下会生成"),t("code",[s._v("kvdb-***.zip")]),s._v("，解压缩安装包，结构如下：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("bin "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 脚本文件目录")]),s._v("\n  start "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动本机的数据库服务的脚本文件")]),s._v("\n  stop "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止本机的数据库服务的脚本文件")]),s._v("\n  kvdb-cli "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 连接本机的数据库服务控制台的脚本文件")]),s._v("\n  kvdb-benchmark "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 基准测试")]),s._v("\nconf "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置文件目录")]),s._v("\n  kvdb.conf "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 本机的数据库服务配置")]),s._v("\n  cluster.conf "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据库集群的配置")]),s._v("\nlibs "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据库服务的代码库目录")]),s._v("\nsystem "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 系统数据目录")]),s._v("\n  dblist "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 文件记录了本数据库服务实例装载的数据库列表")]),s._v("\n  pid "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 文件记录了本数据库服务实例的运行进程ID；当服务实例运行时创建，服务实例退出后删除")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("h2",{attrs:{id:"部署配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#部署配置"}},[s._v("#")]),s._v(" 部署配置")]),s._v(" "),t("h3",{attrs:{id:"kvdb-conf"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kvdb-conf"}},[s._v("#")]),s._v(" "),t("code",[s._v("kvdb.conf")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据库服务的本机监听地址；")]),s._v("\nserver.host"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据库服务的本机监听端口；")]),s._v("\nserver.port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7078")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 管理控制台的端口；")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注：管理控制台总是绑定到环回地址 127.0.0.1，只允许本机访问；")]),s._v("\nmanager.port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7060")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据库实例默认的根目录")]),s._v("\ndbs.rootdir"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/kvdb/dbs\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据库实例默认的本地分区数")]),s._v("\ndbs.partitions"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("h3",{attrs:{id:"cluster-conf"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cluster-conf"}},[s._v("#")]),s._v(" "),t("code",[s._v("cluster.conf")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据库集群的分片数，每一个分片都赋予唯一的编号，分片编号最小为 0，所有分片的编号必须连续递增")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ‘<name>’表示集群名称，只允许用字母、数字、下划线组成；")]),s._v("\ncluster."),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(".partitions"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据库集群 ‘<name>’ 的第 1 个分片的数据库实例地址(URL格式)；")]),s._v("\ncluster."),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(".0"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("kvdb://"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("host"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(":"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("dbname"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据库集群 ‘<name>’ 的第 2 个分片的数据库实例地址(URL格式)；")]),s._v("\ncluster."),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(".1"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("kvdb://"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("host"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(":"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("dbname"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据库集群 ‘<name>’ 的第 3 个分片的数据库实例地址(URL格式)；")]),s._v("\ncluster."),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(".2"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("kvdb://"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("host"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(":"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("dbname"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定多个不同的集群")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#cluster.<name1>.partitions=3")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("blockquote",[t("p",[s._v("一个数据库实例只能加入唯一的集群；一旦加入集群，则不能再被客户端以单库连接方式访问，对该库实例的连接自动转为集群连接。集群中配置的数据库必须在"),t("code",[s._v("dblist")]),s._v("中已存在且设置为"),t("code",[s._v("true")])])]),s._v(" "),t("h3",{attrs:{id:"dblist"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dblist"}},[s._v("#")]),s._v(" "),t("code",[s._v("dblist")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否激活数据库 ‘<name>’ ；如果为`true`，则创建或加载该数据库并提供访问；")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ‘<name>’表示数据库名称，只允许用字母、数字、下划线组成；")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# db.<name>.enable=true")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据库 <name> 的根目录；如果未配置，则从默认目录加载(由`conf/kvdb.conf`指定了默认配置${dbs.rootdir}/<name>)；")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# db.test.rootdir=")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据库 <name> 的本地分区数；如果未配置，则采用`conf/kvdb.conf`中指定的默认配置${dbs.partitions}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# db.test.partitions=")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("blockquote",[t("p",[t("code",[s._v("dblist")]),s._v("中配置的数据库会在"),t("code",[s._v("kvdb-server")]),s._v("启动时自动创建。在"),t("code",[s._v("kvdb-server")]),s._v("启动完成后由管理工具执行"),t("code",[s._v("create database <name>")]),s._v("创建数据库，创建成功的数据库会追加到"),t("code",[s._v("dblist")]),s._v("中。使用"),t("code",[s._v("kvdb-cli")]),s._v("命令行工具执行数据库实例更新操作。")])]),s._v(" "),t("h3",{attrs:{id:"日志"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#日志"}},[s._v("#")]),s._v(" 日志")]),s._v(" "),t("ol",[t("li",[t("code",[s._v("kvdb-server")])])]),s._v(" "),t("p",[s._v("修改"),t("code",[s._v("bin")]),s._v("目录下，"),t("code",[s._v("start.sh")]),s._v("文件：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LOG_SET")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-Dlogging.path="')]),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/logs"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('" -Dlogging.level=error"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("默认日志路径：程序解压缩后主目录下"),t("code",[s._v("logs")]),s._v("目录\n默认日志等级："),t("code",[s._v("error")])]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[t("code",[s._v("kvdb-cli")])])]),s._v(" "),t("p",[s._v("修改"),t("code",[s._v("bin")]),s._v("目录下，"),t("code",[s._v("kvdb-cli.sh")]),s._v("文件：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LOG_SET")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-Dlogging.path="')]),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/logs"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('" -Dlogging.level.root=error"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("默认日志路径：程序解压缩后主目录下"),t("code",[s._v("logs")]),s._v("目录\n默认日志等级："),t("code",[s._v("error")])]),s._v(" "),t("h3",{attrs:{id:"启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[s._v("#")]),s._v(" 启动")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("./start.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"停止"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#停止"}},[s._v("#")]),s._v(" 停止")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("./stop.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"sdk"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sdk"}},[s._v("#")]),s._v(" SDK")]),s._v(" "),t("ol",[t("li",[s._v("依赖")])]),s._v(" "),t("div",{staticClass:"language-maven line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("<dependency>\n\t<groupId>com.jd.blockchain</groupId>\n\t<artifactId>kvdb-client</artifactId>\n\t<version>${version}</version>\n</dependency>\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("创建客户端连接")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// `host`、`port`为服务器地址和端口，`database`为数据库名称")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KVDBClient")]),s._v(" client "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KVDBClient")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kvdb://<host>:<port>/<database>"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("操作")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * 存在性查询\n *\n * @param key\n * @return\n * @throws KVDBException\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("exists")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Bytes")]),s._v(" key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KVDBException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * 存在性查询，支持多个键值\n *\n * @param keys\n * @return\n * @throws KVDBException\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("exists")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Bytes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" keys"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KVDBException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * 键值获取\n *\n * @param key\n * @return\n * @throws KVDBException\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Bytes")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Bytes")]),s._v(" key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KVDBException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * 键值获取，支持多个键值\n *\n * @param keys\n * @return\n * @throws KVDBException\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Bytes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Bytes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" keys"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KVDBException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * 设置键值对\n *\n * @param key\n * @param value\n * @return\n * @throws KVDBException\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Bytes")]),s._v(" key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Bytes")]),s._v(" value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KVDBException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * 开启批处理\n *\n * @return\n * @throws KVDBException\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("batchBegin")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KVDBException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * 取消批处理\n *\n * @return\n * @throws KVDBException\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("batchAbort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KVDBException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * 提交批处理，服务器掉线重连后会丢失未提交批处理数据\n * <p>\n * 未提交的`batch`对其他客户端连接不可见。\n *\n * @return\n * @throws KVDBException\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("batchCommit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KVDBException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n* 关闭客户端\n*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("close")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br")])]),t("h2",{attrs:{id:"管理工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#管理工具"}},[s._v("#")]),s._v(" 管理工具")]),s._v(" "),t("p",[t("code",[s._v("kvdb-cli")]),s._v("是基于"),t("a",{attrs:{href:"#SDK"}},[t("code",[s._v("SDK")])]),s._v("的命令行工具实现：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("./kvdb-cli.sh -h "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("kvdb server host"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("kvdb server port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -db "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("database"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -t "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("time out "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" milliseconds"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  -rt "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("retry "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("times")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v(" out"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -bs "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("buffer size"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -k "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("keep alive"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("参数说明：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("-h")]),s._v(" 服务器地址。选填，默认"),t("code",[s._v("localhost")])]),s._v(" "),t("li",[t("code",[s._v("-p")]),s._v(" 端口。选填，默认"),t("code",[s._v("6070")])]),s._v(" "),t("li",[t("code",[s._v("-db")]),s._v(" 数据库。选填")]),s._v(" "),t("li",[t("code",[s._v("-t")]),s._v(" 超时时间，毫秒。选填，默认"),t("code",[s._v("60000 ms")])]),s._v(" "),t("li",[t("code",[s._v("-rt")]),s._v(" 超时重试等待次数。选填，默认"),t("code",[s._v("5")])]),s._v(" "),t("li",[t("code",[s._v("-bs")]),s._v(" 发送/接收缓冲区大小。选填，默认"),t("code",[s._v("1024*1024")])]),s._v(" "),t("li",[t("code",[s._v("-k")]),s._v(" 保持连接。选填，默认"),t("code",[s._v("true")])])]),s._v(" "),t("p",[s._v("所有支持指令操作：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("localhost:706"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v("help\nAVAILABLE COMMANDS\n\nBuilt-In Commands\n        clear: Clear the shell screen.\n        exit, quit: Exit the shell.\n        help: Display "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),s._v(" about available commands.\n        stacktrace: Display the full stacktrace of the last error.\n\nKVDB Commands\n        batch abort: 取消批处理\n        batch begin: 开启批处理\n        batch commit: 提交批处理\n        cluster info: 服务器集群配置信息\n        create database: 创建数据库实例\n        disable database: 关闭数据库实例，加入集群的实例不可修改\n        drop database: 删除数据库实例，加入集群的实例不可修改\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" database: 开放数据库实例，加入集群的实例不可修改\n        exists: 检查存在性\n        get: 获取键值\n        put, set: 设置键值\n        show databases: 展示数据库实例列表\n        status: 当前数据库信息\n        use: 切换数据库\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br")])]),t("p",[s._v("指令帮助（以"),t("code",[s._v("put")]),s._v("为例）：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("localhost:706"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v("help put\n\nNAME\n\tput - Set a key-value\n\nSYNOPSYS\n\tput "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" string  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" string\n\nOPTIONS\n\t--key  string\n\n\t\t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Mandatory"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n\t--value  string\n\n\t\t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Mandatory"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\nALSO KNOWN AS\n\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("p",[s._v("示例（可执行如下指令插入数据）：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("localhost:706"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v("put k "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("v")]),s._v("\nlocalhost:706"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v("set k "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("v")]),s._v("\nlocalhost:706"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v("put --key k --value "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("v")]),s._v("\nlocalhost:706"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v("set --key k --value "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("v")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h2",{attrs:{id:"benchmark"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#benchmark"}},[s._v("#")]),s._v(" Benchmark")]),s._v(" "),t("p",[t("code",[s._v("kvdb-sever")]),s._v("性能测试工具，简单的数据插入测试。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("./kvdb-benchmark.sh -h "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("kvdb server host"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("kvdb server port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -db "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("database"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -c "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("time out "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" milliseconds"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  -n "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("retry "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("times")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v(" out"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -b "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("buffer size"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -k "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("keep alive"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("参数说明：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("-h")]),s._v(" 服务器地址。选填，默认"),t("code",[s._v("localhost")])]),s._v(" "),t("li",[t("code",[s._v("-p")]),s._v(" 端口。选填，默认"),t("code",[s._v("7078")])]),s._v(" "),t("li",[t("code",[s._v("-db")]),s._v(" 数据库。必填")]),s._v(" "),t("li",[t("code",[s._v("-c")]),s._v(" 客户端数量。选填，默认"),t("code",[s._v("20")])]),s._v(" "),t("li",[t("code",[s._v("-n")]),s._v(" 请求数量。选填，默认"),t("code",[s._v("100000")])]),s._v(" "),t("li",[t("code",[s._v("-b")]),s._v(" 是否使用批处理。选填，默认"),t("code",[s._v("false")])]),s._v(" "),t("li",[t("code",[s._v("-k")]),s._v(" 保持连接。选填，默认"),t("code",[s._v("true")])])]),s._v(" "),t("p",[s._v("示例：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("./kvdb-benchmark.sh -db test1 -c "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000000")]),s._v("\nrequests:1000000, clients:20, batch:false, times:22113ms, errors:0, tps:45222.267444\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("其中：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("requests")]),s._v(" 请求数量")]),s._v(" "),t("li",[t("code",[s._v("clients")]),s._v(" 并发数")]),s._v(" "),t("li",[t("code",[s._v("batch")]),s._v(" 是否开启批量模式")]),s._v(" "),t("li",[t("code",[s._v("times")]),s._v(" 总耗时")]),s._v(" "),t("li",[t("code",[s._v("tps")]),s._v(" TPS")])]),s._v(" "),t("p",[s._v("可根据"),t("code",[s._v("tps")]),s._v("值，调整"),t("code",[s._v("kvdb.conf")]),s._v("中"),t("code",[s._v("dbs.partitions")]),s._v("数值，以寻找最优服务器配置。")])])}),[],!1,null,null,null);a.default=e.exports}}]);